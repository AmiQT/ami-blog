---
import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import BlogPost from '../../components/BlogPost.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

type Props = CollectionEntry<'blog'>;

const { post } = Astro.props;
const { Content } = await post.render();

// Breadcrumb items
const breadcrumbItems = [
  { label: 'Home', href: '/' },
  { label: 'Blog', href: '/blog' },
  { label: post.data.title }
];

// SEO metadata
const seoProps = {
  title: post.data.title,
  description: post.data.description,
  image: post.data.heroImage || '/images/ai-review-site-og.jpg',
  type: 'article',
  publishedTime: post.data.pubDate.toISOString(),
  modifiedTime: post.data.updatedDate ? post.data.updatedDate.toISOString() : post.data.pubDate.toISOString(),
  author: 'AI Review Team',
  tags: post.data.tags
};
---

<Layout {...seoProps}>
  <!-- Hero Section -->
  <section class="py-16 bg-white border-b border-gray-200">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <Breadcrumbs items={breadcrumbItems} />
        <div class="text-center">
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-6 leading-tight tracking-tight">
            {post.data.title}
          </h1>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed">
            {post.data.description}
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Article Content -->
  <section class="py-12 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <BlogPost post={post} content={Content}>
          <Content />
        </BlogPost>
      </div>
    </div>
  </section>
</Layout>
