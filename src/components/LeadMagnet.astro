---
export interface Props {
  title: string;
  subtitle: string;
  image?: string;
  features: string[];
  ctaText: string;
  bonusText?: string;
}

const { title, subtitle, image = "/images/placeholder.svg", features, ctaText, bonusText } = Astro.props;
---

<div class="bg-gradient-to-br from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-8">
  <div class="flex flex-col lg:flex-row items-center gap-8">
    <!-- Content -->
    <div class="flex-1">
      <h3 class="text-2xl font-bold text-gray-900 mb-3">{title}</h3>
      <p class="text-gray-600 mb-6">{subtitle}</p>
      
      <div class="space-y-3 mb-6">
        {features.map((feature) => (
          <div class="flex items-center">
            <svg class="w-5 h-5 text-green-500 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            <span class="text-gray-700">{feature}</span>
          </div>
        ))}
      </div>

      {bonusText && (
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
          <div class="flex items-center">
            <svg class="w-5 h-5 text-yellow-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
            </svg>
            <span class="text-sm font-medium text-yellow-800">{bonusText}</span>
          </div>
        </div>
      )}

      <form class="space-y-4" data-leadmagnet="true">
        <input 
          type="email" 
          placeholder="Enter your email address"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
          required
        >
        <button 
          type="submit"
          class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 transition-colors"
        >
          {ctaText}
        </button>
      </form>
      
      <p class="text-xs text-gray-500 mt-3 text-center">
        No spam, unsubscribe anytime. We respect your privacy.
      </p>
    </div>

    <!-- Image -->
    <div class="lg:w-1/3">
      <div class="bg-white rounded-lg p-4 shadow-lg">
        <img 
          src={image} 
          alt="AI Tools Guide"
          class="w-full h-48 object-cover rounded-lg"
        >
        <div class="mt-4 text-center">
          <div class="text-sm text-gray-500">Free Download</div>
          <div class="text-lg font-semibold text-gray-900">AI Tools Guide</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Basic client-side handling; replace with ESP submission as needed
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form[data-leadmagnet="true"]');
    if (!form) return;
    const emailInput = form.querySelector('input[type="email"]');
    const button = form.querySelector('button[type="submit"]');

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const email = (emailInput && emailInput.value || '').trim();
      if (!email || !email.includes('@')) {
        if (emailInput) {
          emailInput.classList.add('border-red-500');
          setTimeout(() => emailInput.classList.remove('border-red-500'), 2000);
        }
        return;
      }

      if (typeof gtag !== 'undefined') {
        gtag('event', 'leadmagnet_submit', { event_category: 'conversion', value: 1 });
      }

      if (button) {
        button.textContent = 'Sent! Check your inbox';
        button.classList.add('bg-green-600');
      }
      if (emailInput) emailInput.value = '';
    });
  });
</script>
